<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="assets/css/estilos.css">
		<title>Topic 1 - Javascript Intro and jQuery</title>
	</head>
	<body>
		<div class="wrapper">
			<header>
				<h1>Lorem ipsum.</h1>
				<h2>Pablo Demian Rebolini</h2>
				<a href="mailto:rebolini.pablo@gmail.com">[Contacto]</a>
			</header>

			<section class="top-section">
				Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, repudiandae tempore reprehenderit facere optio iure incidunt necessitatibus nemo iste aperiam. Reprehenderit, optio nobis illum quos mollitia velit perspiciatis libero corporis.
			</section>

			<button class="js-welcome">
				<a href="index.html">Home</a>
			</button>

			<section class="hidden">
				Hello World!
				<textarea cols="15" rows="1" class="alias" placeholder="Name..."></textarea>
			</section>

			<footer>
				Lorem ipsum. All Right Reserved
			</footer>		
		</div>

		<!-- jQuery Lastest -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script>
			$(document).ready(function () {
				var name
				,	url  = 'http://bootcamp.aws.af.cm/welcome/'
				,	$ts  = $('.top-section');

				$('.js-welcome').on('click', function (e){
					e.preventDefault();
					name = $('.alias').val();

					// Validacion
					if(name.length === 0){
						$ts.addClass('error-text').html('Name cannot be empty');
						return;
					}

					$.get(url + name, function (data){

						// Quitamos la clase error-text si estubiera
						// e inyectamos el span con el response...						
						$ts.removeClass('error-text').html(data.response);
						
						// Resaltamos el nombre
						highlight(name);

					}, 'json').fail(function () {
						$ts.addClass('error-text')
						   .html('Ups... Error !');
					});

				});

				$('.hidden').fadeIn('slow', function () {
					$('.alias').focus();
				});				
			});

			var highlight = (function(text){
				var content = $('.top-section').html();
				$('.top-section').html(content.replace(text, "<span class='highlight'>"+text+"</a>"));
			});
		</script>
	</body>
</html>